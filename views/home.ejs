<% include partials/header %>


<main class="home-page-content">
  <section class="widgets-section">
    <!-- Weather Widget -->
    <div class="weather-widget element-style-1 info-widget">
      <h3>‚õÖ Local Weather</h3>
      The current weather in Barbados is:
      <span class="weather-info main-highlight">
        <%= data.temperature %><span>&#176;C</span> and
        <%= data.skytext %>
        <img class="weather-img" src="<%=data.imageUrl%>" alt="">
      </span>
    </div>
    <!-- Fuel Price widget -->
    <div class="fuel-price-widget element-style-1 info-widget">
      <h3>‚õΩ Prices - $/liter </h3>
      <span class="fuel-price-container">
        <p>Gasoline ($/liter): <span class="fuel-price main-highlight">$<%= data.gasPrice * 2 %></span></p>
        <p>Diesel ($/liter): <span class="fuel-price main-highlight">$<%= data.dieselPrice * 2 %></span></p>
      </span>
    </div>
    <!-- Fx widget -->
    <div class="currency-info-widget element-style-1 info-widget">
      <h3>üí± FX Rates</h3>
      <span class="currency-info-container">
        <p>¬£1 GBP: <span class="fx-rate main-highlight" id="gbp">$<%= data.gbp.toFixed(2) %> BBD</span></p>
        <p>$1 CAD: <span class="fx-rate main-highlight" id="cad">$<%= data.cad.toFixed(2) %> BBD</span></p>
      </span>
    </div>
  </section>


  <!-- Website Description -->
  <div class="welcome-text element-style-1">
    <h1 class="page-title">üì∞ Mobaton-a News</h1>
    <h3>Your Bajan News Aggregator Site</h3>
    <p>Browse the latest news from several local news sites updated hourly‚è∞</p>
  </div>

  <!-- Filter Div -->
  <div class="filter-div-container">
    <div class="filter-div element-style-1">
      <p class="filter-text">
        <i class="fas fa-filter"></i>
        Filters:
      </p>
      <p>
        <a href="/" class="filter" id="recent">Most Recent‚è≥</a>
      </p>
      <p>
        <a href="/filter/corona" class="filter" id="corona">COVID-19ü¶†</a>
      </p>
      <p>
        <a href="/filter/daily" class="filter" id="daily">Today‚åö</a>
      </p>
      <p>
        <a href="/filter/yesterday" class="filter" id="yesterday">Yesterday‚åõ</a>
      </p>
      <p>
        <a href="/filter/tomorrow" class="filter">TomorrowüîÆ</a>
      </p>
    </div>
  </div>

  <div style="text-align: center;" id="page-name">
    
  </div>

  <div class="main-content">
    <% for(var i = 0; i < articles.length; i++){ %>
        <% for(var j = 0; j < articles[i].data.length; j++){ %>
          <div class="article-card element-style-1">
            <!-- Article thumbnail -->
            <div class="article-thumbnail-div">
              <%# Show image if an image was scrapped  %>
              <% if(articles[i].data[j].imgURL){ %>
                <a href="<%= articles[i].data[j].link %>" target="_blank">
                  <img src="<%= articles[i].data[j].imgURL %>" alt="" class="article-thumbnail">
                </a>       
              <% } else { %>
                <a href="<%= articles[i].data[j].link %>" target="_blank">
                  <img src="https://cdn.pixabay.com/photo/2019/04/29/16/11/new-4166472_960_720.png" class="article-thumbnail">
                </a>
              <% } %>
            </div>
            <div class="article-headline-div">
              <a href="<%= articles[i].data[j].link %>" target="_blank"<%#prevent event bubbling from anchor element to parent list element%> onclick="event.stopPropagation()" class="article-headline">
                <%= articles[i].data[j].headline %>
              </a>
            </div>
            <!-- Article Summary Information -->
            <div class="article-summary-div">
              <a href="<%= articles[i].data[j].link %>" target="_blank"">
                <p>
                  <%# LIMIT CHARACTER COUNT TO 285 %>
                  <%- articles[i].data[j].summary ? articles[i].data[j].summary.substring(0, 285) : "<br>" %>      
                </p>
              </a>  
            </div>
            <!-- Article Card Footer Div -->
            <div class="article-card-footer" data-articleID="<%=`${i}.${j}`%>">
              <!-- Article Info. Div -->
              <div class="article-card-info-div flex-style-1" data-articleID="<%=`${i}.${j}`%>">
                <div class="website-name-div" data-articleID="<%=`${i}.${j}`%>">
                  <span class="website-name">
                    <a href="<%= siteInfo(articles[i]._id).URL %>" target="_blank">
                      <img class="website-favicon"
                        src="https://s2.googleusercontent.com/s2/favicons?domain=<%= siteInfo(articles[i]._id).URL %>" alt="">
                      <%= siteInfo(articles[i]._id).name %>
                    </a>
                  </span>
                </div>
                <div class="article-date-div" data-articleID="<%=`${i}.${j}`%>">
                  <span class="article-date">
                  üìÖ <%= dateStandardiser(articles[i].data[j].date, articles[i]._id) %>
                  </span>
                </div>
                <i class="fas fa-share-alt share-button" data-articleID="<%=`${i}.${j}`%>"></i>
              </div>        
                <!-- Share Div -->
              <div class="article-share-div hidden flex-style-1" data-articleID="<%=`${i}.${j}`%>">
                Share:
                <!-- WhatsApp Share Link -->
                <a href="https://wa.me/?text=<%= articles[i].data[j].link %>" class="whatsApp-icon">
                  <i class="fab fa-whatsapp" style="color: #4FCE5D"></i>
                </a>
                <!--Facebook Share Link  -->
                <a href="https://www.facebook.com/sharer/sharer.php?u=<%= articles[i].data[j].link %>" class="facebook-icon">
                  <i class="fab fa-facebook" style="color:#3B5998"></i>
                </a>
                <i class="fas fa-times hide-share-button" data-articleID="<%=`${i}.${j}`%>"></i>
              </div>
            </div>
          </div>
      <% } %>
    <% } %>
  </div>
</main>


<% include partials/footer %>